/*! tabella - v0.0.1 - 2014-12-20
* https://github.com/iliketomatoes/tabellajs
* Copyright (c) 2014 ; Licensed  */
!function(a){"use strict";"function"==typeof define&&define.amd?define(a):window.Tabella=a()}(function(){"use strict";function a(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function b(a,b,c,d){var e=document.createElement(a);return e.className=b,d&&(e.innerHTML=d),c.appendChild(e),e}function c(a){this.value=a,this.message="Tabella.js error: ",this.toString=function(){return this.message+this.value}}function d(d,e){function f(a,c,d){var e=a.periods,f=document.createDocumentFragment();if(e instanceof Array&&e.length){var g=e.length,h=b("div","period-wrapper",f),i=b("div","row-wrapper",h);i.style.width=d*(g+1)+"px";var j='<div class="period-element">';j+='<div class="period-large-fromto">',j+=a.from,j+="<br>",j+=a.to,j+="</div>",j+="</div>";var k=b("div","period-description",i,j);k.style.width=d+"px";var l=b("div","period-row",i);l.style.width=d*g+"px";for(var m=0;g>m;m++){var n=document.createElement("div");n.className="period-cell",n.style.width=d+"px";var o='<div class="period-fromto">';o+=a.from,"undefined"!=typeof e[m][1]&&(o+="<br>",o+=a.to),o+="</div>",o+='<div class="period-date">',o+="undefined"!=typeof e[m][0]?e[m][0]:"not set","undefined"!=typeof e[m][1]&&(o+="<br>",o+=e[m][1]),o+="</div>";{b("div","period-element",n,o)}l.appendChild(n)}return c.appendChild(f),l}return!1}function g(a,c,d){var e=a.periods,f=a.rows,g=e.length,h=f.length,i=document.createDocumentFragment();if(h>0){for(var j=!0,k=0;h>k&&j;k++){var l=b("div","item-wrapper",i);if(f[k].desc){b("section","item-desc",l,f[k].desc)}if(f[k].prices)for(var m=0;m<f[k].prices.length&&j;m++){var n=b("div","item-row",l);n.style.width=d*g+"px";for(var o=0;o<f[k].prices[m].length;o++){if(f[k].prices[m].length!==g){j=!1;break}var p=document.createElement("div"),q="item-cell";m>=1&&(q+=" cell-border-top"),p.className=q,p.style.width=d+"px";var r="";f[k].pricesDesc[m]&&(r+='<div class="item-cell-desc">',f[k].pricesDesc[m][o]?r+=f[k].pricesDesc[m][o]:f[k].pricesDesc[m][0]&&(r+=f[k].pricesDesc[m][0]),r+="</div>"),r+='<div class="item-value">',r+="undefined"!=typeof f[k].prices[m][o]?f[k].prices[m][o]:"not set",r+=" "+a.currency,r+="</div>";{b("div","item-element",p,r)}n.appendChild(p)}}}return c.appendChild(i),j}return!1}function h(){}if(this.defaults={periods:null,rows:null,breakpoints:{small:[360,2],medium:[640,3],large:[820,4],xlarge:[1080,5]},from:"from",to:"to",borderWidth:1,currency:"&euro;"},this.periodRow=null,this.currentBreakpoint=[0,1],this.cellWidth=0,this.el=d,"undefined"==typeof d)throw new c("You did not pass a valid target element to the constructor");if("undefined"==typeof e)throw new c("You did not pass any options to the constructor");if(this.options=a(this.defaults,e),this.getBreakpoint=function(){var a=this,b=0,c=a.el.clientWidth,d=a.options.breakpoints;for(var e in d){var f=d[e][0];"number"==typeof f&&f>0&&c>=f&&Math.abs(c-f)<Math.abs(c-b)&&(b=f,a.currentBreakpoint=d[e])}return a.currentBreakpoint},this.getCellWidth=function(){var a,b,c=this,d=c.options.periods.length+1;return a=c.getBreakpoint(),console.log(c.el.parentNode.clientWidth),b=a[1]>d?c.el.clientWidth/numberOfPeriods:c.el.clientWidth/a[1],console.log(b),console.log(c.el.clientWidth),Math.round(b)},null===this.options.periods||null===this.options.rows)throw new c("Periods or rows are null");if(this.cellWidth=this.getCellWidth(),this.periodRow=f(this.options,this.el,this.cellWidth,this.el.clientWidth),!this.periodRow)throw new c("Periods is not an Array");if(!g(this.options,this.el,this.cellWidth,this.el.clientWidth))throw new c("There is a mismatch between periods and prices cells");h(this.options,this.el,this.periodRow);var i=this;window.onload=function(){i.refreshSize()}}return d.prototype.refreshSize=function(){var a=this;console.log(a),console.log(a.periodRow)},d});