/*! tabella - v0.0.1 - 2014-12-23
* https://github.com/iliketomatoes/tabellajs
* Copyright (c) 2014 ; Licensed  */
!function(a){"use strict";"function"==typeof define&&define.amd?define(a):window.Tabella=a()}(function(){"use strict";function a(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function b(a,b){var c=i(a,b)?k:j;c(a,b)}function c(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function d(a,b,c,d){var e=document.createElement(a);return e.className=b,d&&(e.innerHTML=d),c.appendChild(e),e}function e(a){return Array.prototype.slice.call(a,0)}function f(a){this.value=a,this.message="Tabella.js error: ",this.toString=function(){return this.message+this.value}}function g(a,b){this.options=a,this.el=b}function h(a,b){if(this.defaults={periods:null,rows:null,cellBreakpoints:{"default":[0,1],small:[360,2],medium:[640,3],large:[820,4],xlarge:[1080,5]},descBreakpoints:{"default":[0,0],medium:[460,160],large:[900,200]},from:"from",to:"to",borderWidth:1,currency:"&euro;",arrowLeft:'<img src="dist/assets/img/left-arrow.svg" alt="left-arrow">',arrowRight:'<img src="dist/assets/img/right-arrow.svg" alt="right-arrow">'},this.periodRow=null,this.arrows=null,this.currentBreakpoint={},this.cellWidth=0,this.el=a,"undefined"==typeof a)throw new f("You did not pass a valid target element to the constructor");if("undefined"==typeof b)throw new f("You did not pass any options to the constructor");this.options=c(this.defaults,b);var d=this;if(null===d.options.periods||null===d.options.rows)throw new f("Periods or rows are null");var e=new g(d.options,d.el);if(d.periodRow=e.setUpPeriods(),!d.periodRow)throw new f("Periods is not an Array");if(!e.setUpRows())throw new f("There is a mismatch between periods and prices cells");d.arrows=e.setUpArrows(d.periodRow);var h=function(a,b,c){var e,f=d;return function(){var d=arguments,g=function(){e=null,c||a.apply(f,d)},h=c&&!e;clearTimeout(e),e=setTimeout(g,b),h&&a.apply(f,d)}};window.addEventListener("resize",h(d.refreshSize,250)),window.addEventListener("load",h(d.refreshSize,50))}var i,j,k;"classList"in document.documentElement?(i=function(a,b){return a.classList.contains(b)},j=function(a,b){a.classList.add(b)},k=function(a,b){a.classList.remove(b)}):(i=function(b,c){return a(c).test(b.className)},j=function(a,b){i(a,b)||(a.className=a.className+" "+b)},k=function(b,c){b.className=b.className.replace(a(c)," ")});var l={hasClass:i,addClass:j,removeClass:k,toggleClass:b,has:i,add:j,remove:k,toggle:b};return g.prototype.setUpPeriods=function(){var a=this,b=a.options.periods,c=document.createDocumentFragment();if(b instanceof Array&&b.length){var e=b.length,f=d("div","t-row",c),g=d("div","t-row-content",f),h='<div class="t-element">';h+='<div class="t-cell-desc-l">',h+=a.options.from,h+="<br>",h+=a.options.to,h+="</div>",h+="</div>";for(var i=(d("div","t-row-desc",g,h),d("div","t-row-values",g)),j=0;e>j;j++){var k=document.createElement("div");k.className="t-row-cell";var l='<div class="t-cell-desc-s">';l+=a.options.from,"undefined"!=typeof b[j][1]&&(l+="<br>",l+=a.options.to),l+="</div>",l+='<div class="t-cell-value">',l+="undefined"!=typeof b[j][0]?b[j][0]:"not set","undefined"!=typeof b[j][1]&&(l+="<br>",l+=b[j][1]),l+="</div>";{d("div","t-element",k,l)}i.appendChild(k)}return a.el.appendChild(c),f}return!1},g.prototype.setUpRows=function(){var a=this,b=a.options.periods,c=a.options.rows,e=b.length,f=c.length,g=document.createDocumentFragment();if(f>0){for(var h=!0,i=0;f>i&&h;i++){var j=d("div","t-row",g);if(c[i].desc){d("section","t-row-header",j,c[i].desc)}if(c[i].prices)for(var k=0;k<c[i].prices.length;k++){var l=d("div","t-row-content",j);if(!h)break;var m='<div class="t-element">';m+='<div class="t-cell-desc-l">',m+=c[i].pricesDesc[k],m+="</div>",m+="</div>";var n="t-row-desc";k>=1&&(n+=" t-cell-border-top");for(var o=(d("div",n,l,m),d("div","t-row-values",l)),p=0;p<c[i].prices[k].length;p++){if(c[i].prices[k].length!==e){h=!1;break}var q=document.createElement("div"),r="t-row-cell";k>=1&&(r+=" t-cell-border-top"),q.className=r;var s="";c[i].pricesDesc[k]&&(s+='<div class="t-cell-desc-s">',c[i].pricesDesc[k][p]?s+=c[i].pricesDesc[k][p]:c[i].pricesDesc[k][0]&&(s+=c[i].pricesDesc[k][0]),s+="</div>"),s+='<div class="t-cell-value">',s+="undefined"!=typeof c[i].prices[k][p]?c[i].prices[k][p]:"not set",s+=" "+a.options.currency,s+="</div>";{d("div","t-element",q,s)}o.appendChild(q)}}}return a.el.appendChild(g),h}return!1},g.prototype.setUpArrows=function(a){var b=this,c=d("div","t-arr-right",a,b.options.arrowRight),e=d("div","t-arr-left",a,b.options.arrowLeft);return{arrowRight:c,arrowLeft:e}},g.prototype.attachEvents=function(){},h.prototype.refreshSize=function(){var a=this,b=a.getBreakpoint();console.log("resized");var c=a.getCellWidth(b),d=b.descBreakpoint[1],f=a.options.periods.length,g=e(a.el.querySelectorAll(".t-row"));g.forEach(function(a){var g=e(a.querySelectorAll(".t-row-content"));g.forEach(b.descBreakpoint[1]>0?function(a){a.style.width=d+f*c+"px";var b=a.querySelector(".t-row-desc");b.style.width=d+"px",l.remove(b,"t-hide"),e(a.querySelectorAll(".t-row-cell")).forEach(function(a){a.style.width=c+"px"}),e(a.querySelectorAll(".t-cell-desc-s")).forEach(function(a){l.add(a,"t-hide")})}:function(a){a.style.width=f*c+"px",l.add(a.querySelector(".t-row-desc"),"t-hide"),e(a.querySelectorAll(".t-row-cell")).forEach(function(a){a.style.width=c+"px"}),e(a.querySelectorAll(".t-cell-desc-s")).forEach(function(a){l.remove(a,"t-hide")})})})},h.prototype.getCellWidth=function(a){var b,c=this,d=c.options.periods.length,e=a.cellBreakpoint,f=a.descBreakpoint;return b=e[1]>d?(c.el.clientWidth-f[1])/d:(c.el.clientWidth-f[1])/e[1],Math.round(b)},h.prototype.getBreakpoint=function(){var a=this,b=0,c=a.el.clientWidth,d=a.options.cellBreakpoints,e=a.options.descBreakpoints,f=[0,1],g=[0,0];for(var h in d){var i=d[h][0];"number"==typeof i&&i>0&&c>=i&&Math.abs(c-i)<Math.abs(c-b)&&(b=i,f=d[h])}b=0;for(var j in e){var k=e[j][0];"number"==typeof k&&k>0&&c>=k&&Math.abs(c-k)<Math.abs(c-b)&&(b=k,g=e[j])}return{cellBreakpoint:f,descBreakpoint:g}},h});